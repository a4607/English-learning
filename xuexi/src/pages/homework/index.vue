<template>
  <view class="homework-page">
    <view class="header">
      <text class="title">本周作业</text>
      <text class="sub">根据老师布置完成以下任务</text>
    </view>

    <scroll-view class="list" scroll-y>
      <view v-for="task in tasks" :key="task.id" class="task-card" :class="{ done: task.done }" @click="openTask(task)">
        <view class="task-left"><view class="task-icon">{{ task.icon }}</view></view>
        <view class="task-body">
          <text class="task-title">{{ task.title }}</text>
          <text class="task-desc">{{ task.desc }}</text>
          <view class="meta">
            <text class="meta-item">截止：{{ task.due }}</text>
            <text class="meta-item" :class="{ highlight: task.urgent }">{{ task.urgent ? '紧急' : '常规' }}</text>
          </view>
        </view>
        <view class="task-right">
          <view class="status-dot" :class="{ ok: task.done }"></view>
          <text class="status-text">{{ task.done ? '已完成' : '待完成' }}</text>
          <button class="cta" @click.stop="startTask(task)">{{ task.done ? '查看' : '去完成' }}</button>
        </view>
      </view>
    </scroll-view>

    <!-- 新底部导航（仿多邻国） -->
    <view class="duo-bottom">
      <view class="duo-item" @click="goToSync"><image class="duo-icon" src="https://d35aaqx5ub95lt.cloudfront.net/vendor/fbe0c187341c280e161f76fb4cbda1d7.svg" /></view>
      <view class="duo-item" @click="goToPronounce"><image class="duo-icon" src="https://d35aaqx5ub95lt.cloudfront.net/vendor/3b4928101472fce4e9edac920c1b3817.svg" /></view>
      <view class="duo-item active"><image class="duo-icon" src="https://d35aaqx5ub95lt.cloudfront.net/vendor/5d2ba4a4504db1b554515043e94cc7da.svg" /></view>
      <view class="duo-item" @click="goToShop"><image class="duo-icon" src="https://d35aaqx5ub95lt.cloudfront.net/vendor/0e58a94dda219766d98c7796b910beee.svg" /></view>
      <view class="duo-item" @click="goToMine"><image class="duo-icon" src="https://d35aaqx5ub95lt.cloudfront.net/vendor/e93ac282acf802a6258c761d3e9f9888.svg" /></view>
    </view>
  </view>
</template>

<script setup>
import { ref } from 'vue'

const tasks = ref([
  { id: 1, title: '预习词汇与句子', desc: '完成当前单元词句预习', due: '本周五', icon: '📚', route: '/pages/vocab/index', urgent: false, done: false },
  { id: 2, title: '预习内容检测', desc: '完成本课时检查题', due: '本周五', icon: '✅', route: '/pages/preview/index', urgent: true, done: false },
  { id: 3, title: '口语跟读练习', desc: '至少完成10个词/句的跟读', due: '本周日', icon: '🎤', route: '/pages/index/readaloud/index', urgent: false, done: false }
])

const openTask = (task) => { uni.showToast({ title: task.title, icon: 'none' }) }
const startTask = (task) => { if (task.route) uni.navigateTo({ url: task.route }) }

// 底部导航功能
const goToSync = () => { uni.reLaunch ? uni.reLaunch({ url: '/pages/index/index' }) : uni.navigateTo({ url: '/pages/index/index' }) }
const goToPronounce = () => { uni.navigateTo({ url: '/pages/index/readaloud/index' }) }
const goToShop = () => { uni.showToast({ title: '小店（占位）', icon: 'none' }) }
const goToMine = () => { uni.navigateTo({ url: '/pages/mine/index' }) }
</script>

<style scoped>
.homework-page { min-height:100vh; background: var(--duo-surface); display:flex; flex-direction:column; padding-bottom:64px }
.header { padding:16px }
.title { display:block; font-size:20px; font-weight:800; color: var(--duo-text) }
.sub { display:block; margin-top:6px; color: var(--duo-muted); font-size:12px }
.list { flex:1; padding:8px 16px }
.task-card { display:flex; gap:12px; padding:16px; border:1px solid var(--duo-border); border-radius: var(--duo-radius); margin-bottom:12px; align-items:center; box-shadow: var(--duo-shadow) }
.task-card.done { opacity:.7 }
.task-left { width:44px; height:44px; display:flex; align-items:center; justify-content:center; background:#f3f4f6; border-radius:8px }
.task-icon { font-size:22px }
.task-body { flex:1 }
.task-title { display:block; font-size:16px; font-weight:700; color: var(--duo-text) }
.task-desc { display:block; font-size:12px; color: var(--duo-muted); margin-top:4px }
.meta { margin-top:8px; display:flex; gap:10px }
.meta-item { font-size:12px; color: var(--duo-muted) }
.meta-item.highlight { color:#ef4444 }
.task-right { display:flex; flex-direction:column; align-items:flex-end; gap:8px }
.status-dot { width:10px; height:10px; border-radius:50%; background:#f59e0b }
.status-dot.ok { background:#22c55e }
.status-text { font-size:12px; color: var(--duo-muted) }
.cta { border:none; background: var(--duo-primary); color:#fff; padding:8px 12px; border-radius:10px; font-size:12px }

/* 新底部导航 */
.duo-bottom { position: fixed; left:0; right:0; bottom:0; display:flex; justify-content:space-around; align-items:center; background:#fff; border-top:1px solid var(--duo-border); padding:8px 0; z-index:10000 }
.duo-item { padding:6px 10px; border-radius:10px }
.duo-item.active { background:#eef7e6 }
.duo-icon { width:28px; height:28px }
</style>

